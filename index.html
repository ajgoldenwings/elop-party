<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Polymer Starter Kit" />
<meta name="mobile-web-app-capable" content="yes"><!-- Add bookmark -->
<title>Elop Party</title>
<!-- Chrome for Android theme color --><meta name="theme-color" content="#47079C">
<!-- Web Application Manifest --><link rel="manifest" href="manifest.json">
<!-- Tile color for Win8 --><meta name="msapplication-TileColor" content="#47079C">
<!-- Add to homescreen for Chrome on Android --><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="PSK"><link rel="icon" sizes="192x192" href="images/touch/chrome-touch-icon-192x192.png">
<!-- Add to homescreen for Safari on iOS --><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="apple-mobile-web-app-title" content="Polymer Starter Kit"><link rel="apple-touch-icon" href="images/touch/apple-touch-icon.png">
<!-- Tile icon for Win8 (144x144) --><meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
<script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
<link rel="import" href="elements/elements.html">


<style is="custom-style" include="shared-styles"></style>
</head>

<body unresolved class="fullbleed layout vertical">
<span id="browser-sync-binding"></span>

<template is="dom-bind" id="app">
<paper-drawer-panel force-narrow id="paperDrawerPanel">
	<paper-scroll-header-panel drawer fixed>
		<paper-toolbar id="drawerToolbar">
			<object class="icon-menu" type="image/svg+xml" data="./images/icons/Icons-Logo.svg"></object><span class="paper-font-title">Menu</span>
		</paper-toolbar>

		<paper-menu class="list" attr-for-selected="data-route" selected="[[route]]">
			<a data-route="home" href="/" on-click="onDataRouteClick" hidden={{isNotLoggedIn}}><iron-icon icon="home"></iron-icon><span>Events</span></a>
			<a data-route="map" href="/map" on-click="onDataRouteClick" hidden={{isNotLoggedInWithUser}}><iron-icon icon="maps:map"></iron-icon><span>Map</span></a>
			<a data-route="settings" href="/settings" on-click="onDataRouteClick" hidden={{isNotLoggedInWithUser}}><iron-icon icon="settings"></iron-icon><span>Settings</span></a>
			<a data-route="more" href="/more" on-click="onDataRouteClick"><iron-icon icon="more-horiz"></iron-icon><span>More</span></a>
			<a data-route="signon" href="/signon" on-click="onDataRouteClick" hidden={{!isNotLoggedIn}}><iron-icon icon="supervisor-account"></iron-icon><span>Sign On</span></a>
		</paper-menu>

		<paper-menu class="list" attr-for-selected="data-route" selected="[[route]]" style="position:absolute;bottom:1em;width:100%;" hidden={{isNotLoggedIn}}>
			<a data-route="logout" href="/logout" on-click="onDataRouteClick"><iron-icon icon="supervisor-account"></iron-icon><span>Log Off</span></a>
		</paper-menu>
	</paper-scroll-header-panel>

	<paper-scroll-header-panel main fixed>

		<paper-toolbar id="mainToolbar">
			<paper-icon-button id="paperToggle" icon="menu" paper-drawer-toggle></paper-icon-button>
			<span class="title alignleft">Elop Party</span>
			<section onclick="clickHandler(event)">
				<paper-icon-button icon="more-vert" data-dialog="buttonspopup"></paper-icon-button>
			</section>
		</paper-toolbar>

		<div class="content">
			<iron-pages attr-for-selected="data-route" selected="{{route}}">
				<section data-route="event">
					<elop-event current_title="{{event_current_title}}" current_time="{{event_current_time}}" current_timeto="{{event_current_timeto}}" current_promoter="{{event_current_promoter}}" current_length="{{event_current_length}}"></elop-event>
				</section>
				<section data-route="event_add">
					<elop-event-add event_title="{{event_title_paper_input}}"></elop-event-add>
				</section>
				<section data-route="events">
					<elop-event-list></elop-event-list>
				</section>
				<section data-route="loading">
					<paper-card heading="Loading"><div class="card-content">Please wait...</div></paper-card>
				</section>
				<section data-route="logingout">
					<paper-card heading="Logging Out"><div class="card-content">Please wait...</div></paper-card>
				</section>
				<section data-route="map">
					<elop-event-map></elop-event-map>
				</section>
				<section data-route="more">
					<elop-about></elop-about>
				</section>
				<section data-route="settings">
					<elop-settings verify_password_paper="{{verify_password_paper_input}}" change_password_paper="{{change_password_paper_input}}" change_verify_password_paper="{{change_verify_password_paper_input}}"></elop-settings>
				</section>
				<section data-route="signon">
					<elop-signon signon_username_paper="{{signon_username_paper_input}}" signon_password_paper="{{signon_password_paper_input}}"></elop-signon>
				</section>
				<section data-route="signup">
					<elop-signup signup_username_paper="{{signup_username_paper_input}}" signup_password_paper="{{signup_password_paper_input}}" signup_verify_password_paper="{{signup_verify_password_paper_input}}"></elop-signup>
				</section>
			</iron-pages>
		</div>

		<script>
			function clickHandler(e) {
				var button = e.target;
				while (!button.hasAttribute('data-dialog') && button !== document.body) {
					button = button.parentElement;
				}

				if (!button.hasAttribute('data-dialog')) {
					return;
				}

				var id = button.getAttribute('data-dialog');
				var dialog = document.getElementById(id);
				if (dialog) {
					dialog.open();
				}
			}
			function eventAdd_validate() {
				if (document.getElementById("event-title-paper-input").validate()&&app.location_status==4&&app.event_length>0&&app.event_date!='') {
					app.isEventSubmittable=true;
					return true;
				}
				else {
					app.isEventSubmittable=false;
					app.event_title_validate();
					return false;
				}
			}
			function setLength(length) {
				var length_in_hours = length/60;
				var length_text = length_in_hours==1?' hour':' hours';
				app.event_length=length;
				document.getElementById("event-length").innerHTML = length_in_hours + length_text;
				eventAdd_validate();
			}
			function setTime(date,time) {
				app.event_date=date;
				document.getElementById("event-time").innerHTML = time;
				eventAdd_validate();
			}
		</script>
		<paper-dialog id="eventlengths" with-backdrop>
			<h2>Event Length</h2>
			<paper-dialog-scrollable>
				<a onclick="setLength(60)"><paper-button dialog-confirm>1 Hour</paper-button></a>
				<a onclick="setLength(90)"><paper-button dialog-confirm>1.5 Hours</paper-button></a>
				<a onclick="setLength(120)"><paper-button dialog-confirm>2 Hours</paper-button></a>
				<a onclick="setLength(150)"><paper-button dialog-confirm>2.5 Hours</paper-button></a>
				<a onclick="setLength(180)"><paper-button dialog-confirm>3 Hours</paper-button></a>
				<a onclick="setLength(210)"><paper-button dialog-confirm>3.5 Hours</paper-button></a>
				<a onclick="setLength(240)"><paper-button dialog-confirm>4 Hours</paper-button></a>
				<a onclick="setLength(270)"><paper-button dialog-confirm>4.5 Hours</paper-button></a>
				<a onclick="setLength(300)"><paper-button dialog-confirm>5 Hours</paper-button></a>
			</paper-dialog-scrollable>
			<hr>
			<div suffix><small>Up to 5 hours</small><br><small>30 Minute Increments</small></div>
		</paper-dialog>
		<paper-dialog id="eventtimes" with-backdrop>
			<h2>Event Start Time</h2><paper-dialog-scrollable><div id="eventTimes"></div></paper-dialog-scrollable>
			<hr><div suffix><small>Times within 12 hours</small><br><small>30 Minute Increments</small></div>
		</paper-dialog>
		<elop-dialog-action loggedin="{{isNotLoggedInWithUser}}" username="{{elop_username}}"></elop-dialog-action>
	</paper-scroll-header-panel>
</paper-drawer-panel>

<!-- next block to enable Service Worker support (1/2) -->
<!--<paper-toast id="caching-complete" duration="6000" text="Caching complete! This app will work offline."></paper-toast><platinum-sw-register auto-register clients-claim skip-waiting on-service-worker-installed="displayInstalledToast"><platinum-sw-cache default-cache-strategy="fastest" cache-config-file="cache-config.json"></platinum-sw-cache></platinum-sw-register>-->

</template>

<elop-swipe-pages></elop-swipe-pages>

<script src="scripts/jquery.min.js"></script>
<script src="baasbox/baasbox-0.8.4.min.js"></script>
<script src="scripts/app.js"></script>
<script src="scripts/helper_event.js"></script>
<script src="scripts/helper_map.js"></script>
<script src="scripts/helper_user.js"></script>
<script src="scripts/generator.js"></script>
<script src="baasbox/baasbox-custom.js"></script>
<script src="scripts/app-custom.js"></script>
<script src="scripts/util.js"></script>
</body>
</html>
