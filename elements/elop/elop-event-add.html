<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../styles/shared-styles.html">

<dom-module id="elop-event-add">

<template>
	<style is="custom-style" include="shared-styles"></style>

	<paper-card heading="Add Event">
		<div class="card-content">
			<paper-input label="Event Title" id="event-title-paper-input" value="{{event_title}}" error-message="At least 5 characters." class="invalid" maxlength="25" minlength="5" char-counter required onkeyup="eventAdd_validate()"></paper-input>

			<br><br>

			<section onclick="clickHandler(event)" class="center">
				<a onclick="app.generateTimes();">
					<paper-button data-dialog="eventtimes">
						<iron-icon icon="schedule"></iron-icon><span>Start Time: </span><div id="event-time" class="inline"></div>
					</paper-button>
				</a>
			</section>

			<section onclick="clickHandler(event)" class="center">
				<paper-button data-dialog="eventlengths">
					<iron-icon icon="image:timer"></iron-icon><span>Event Length: </span><div id="event-length" class="inline"></div>
				</paper-button>
			</section>

			<br><br>

			<div class="vertical-section">
				<div id="event_add_location"></div>
				<paper-progress id="event_location_progress" indeterminate></paper-progress>
				<div id="event_location_progress_label" class="right" style="font-size: 12px;">Finding Location Coordinates</div>
			</div>

			<br>
		</div>
		<div class="card-actions">
			<a data-route="events" href="/events" onclick="document.getElementById('event-title-paper-input').value='';app.event_title_validate();">
				<paper-button raisedButton label="Click">Cancel</paper-button>
			</a>
			<a data-route="events" href="/events" onclick="app.helper_event.event_add();">
				<paper-button raisedButton label="Click" disabled={{!isEventSubmittable}}>Submit</paper-button>
			</a>
		</div>
	</paper-card>
	<paper-dialog id="eventlengths" with-backdrop>
		<h2>Event Length</h2>
		<paper-dialog-scrollable>
			<a onclick="setLength(60)"><paper-button dialog-confirm>1 Hour</paper-button></a>
			<a onclick="setLength(90)"><paper-button dialog-confirm>1.5 Hours</paper-button></a>
			<a onclick="setLength(120)"><paper-button dialog-confirm>2 Hours</paper-button></a>
			<a onclick="setLength(150)"><paper-button dialog-confirm>2.5 Hours</paper-button></a>
			<a onclick="setLength(180)"><paper-button dialog-confirm>3 Hours</paper-button></a>
			<a onclick="setLength(210)"><paper-button dialog-confirm>3.5 Hours</paper-button></a>
			<a onclick="setLength(240)"><paper-button dialog-confirm>4 Hours</paper-button></a>
			<a onclick="setLength(270)"><paper-button dialog-confirm>4.5 Hours</paper-button></a>
			<a onclick="setLength(300)"><paper-button dialog-confirm>5 Hours</paper-button></a>
		</paper-dialog-scrollable>
		<hr>
		<div suffix><small>Up to 5 hours</small><br><small>30 Minute Increments</small></div>
	</paper-dialog>
	<paper-dialog id="eventtimes" with-backdrop>
		<h2>Event Start Time</h2><paper-dialog-scrollable><div id="eventTimes"></div></paper-dialog-scrollable>
		<hr><div suffix><small>Times within 12 hours</small><br><small>30 Minute Increments</small></div>
	</paper-dialog>
</template>

<script>
	(function () {
		'use strict';
		Polymer({
			is: 'elop-event-add',
			properties: {
				event_title: {
					type: String,
					value: "",
					notify: true
				}
			}
		});
	})();
	function eventAdd_validate() {
		if (document.getElementById("event-title-paper-input").validate()&&app.location_status==4&&app.event_length>0&&app.event_date!='') {
			app.isEventSubmittable=true;
			return true;
		} else {
			app.isEventSubmittable=false;
			app.event_title_validate();
			return false;
		}
	}
	function setLength(length) {
		var length_in_hours = length/60;
		var length_text = length_in_hours==1?' hour':' hours';
		app.event_length=length;
		document.getElementById("event-length").innerHTML = length_in_hours + length_text;
		eventAdd_validate();
	}
	function setTime(date,time) {
		app.event_date=date;
		document.getElementById("event-time").innerHTML = time;
		eventAdd_validate();
	}
</script>
</dom-module>